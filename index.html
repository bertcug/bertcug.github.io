<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>雨意随风的自留地</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="个人技术博客">
<meta property="og:type" content="website">
<meta property="og:title" content="雨意随风的自留地">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="雨意随风的自留地">
<meta property="og:description" content="个人技术博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="雨意随风的自留地">
<meta name="twitter:description" content="个人技术博客">
  
    <link rel="alternate" href="/atom.xml" title="雨意随风的自留地" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">雨意随风的自留地</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">make a little change every day！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-流量劫持" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/01/流量劫持/" class="article-date">
  <time datetime="2017-04-01T03:13:50.000Z" itemprop="datePublished">2017-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/01/流量劫持/">流量劫持</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>流量劫持是网络中常见的网络安全问题，那些情况会造成流量劫持？<strong>腾讯校招笔试题</strong><br>A. MAC地址欺骗<br>B. DNS劫持<br>C. 伪造的DHCP服务器<br>D. 使用https协议</p>
<h2 id="DNS劫持"><a href="#DNS劫持" class="headerlink" title="DNS劫持"></a>DNS劫持</h2><p>​      DNS劫持无疑肯定是，DNS服务负责域名解析，一旦DNS服务器遭受攻击，所有设置该DNS的用户都将受到影响，如果DNS服务器受到黑客控制，黑客可以将正常域名解析到自己的HTTP代理服务器，在不影响受害者上网的情况下进行网络流量监听，想想就可怕！<br>​        当然，DNS劫持也不是只能用来干坏事，DNS解析是本机通过<code>getaddrinfo</code>像DNS服务器进行域名解析的，如果自己设置黑名单，将一些广告或者恶意<code>url</code>屏蔽掉的话，就可以做到去广告和提高安全性了，一些去广告软件也是运用类似原理，让广告的<code>url</code>得不到正确解析所以就无法加载成功了。</p>
<h2 id="MAC地址欺骗"><a href="#MAC地址欺骗" class="headerlink" title="MAC地址欺骗"></a>MAC地址欺骗</h2><p>​      交换机的出现逐渐淘汰了集线器。交换机会绑定 MAC 地址和接口，数据包最终只发往一个终端。因此只要事先配置好 MAC 对应的接口，理论上非常安全了。<br>​       不过，很少有人会那么做，大多为了偷懒，直接使用了设备默认的模式 —— 自动学习。设备根据某个接口发出的包，自动关联该包的源地址到此接口。然而这种学习并不智能，甚至太过死板，任何一个道听途说都会当作真理。用户发送一个自定义源 MAC 地址的包是非常容易的，因此交换机成了非常容易被忽悠的对象。只要伪造一个源地址，就能将这个地址关联到自己的接口上，以此获得受害者的流量。<br>​       不过，受害者接着再发出一个包，绑定关系又恢复原先正常的。因此只要比谁发的频繁，谁就能竞争到这个 MAC 地址的接收权。如果伪造的是网关地址，交换机就误以为网关电缆插到你接口上，网络环境里的出站流量瞬间都到了你这里。<br>​      当然，除非你有其他出站渠道，可以将窃取的数据代理出去；否则就别想再转发给被你打垮的真网关了，被劫持的用户也就没法上外网。所以这招危害性不是很大，但破坏性很强，可以瞬间集体断网。<br>​       防范措施：机器固定的网络尽量绑定 MAC 和接口吧。貌似大多数网吧都绑定了 MAC 和接口，极大增强了链路层的安全性。同时，独立的子网段尽可能划分 VLAN，避免过大的广播环境。</p>
<h2 id="ARP攻击"><a href="#ARP攻击" class="headerlink" title="ARP攻击"></a>ARP攻击</h2><p>​        ARP 就是广播查询某个 IP 对应的 MAC 地址，在用这个 IP 的人回个声。知道这个 IP 对应的 MAC 地址，就可以链路通信了（链路层只能通过MAC地址通信）。<br>​       如果有人冒充回复，并抢在正常人之前，伪造的答案也就先入为主。IP 被解析到错误的地址上，之后所有的通信都被劫持了。<br>​       事实上，早期的系统还有个更严重的BUG：直接给用户发送一个 ARP 回复包，即使对方从没请求过，系统也会接受这个回复，并提前保存里面的记录。这种基于缓存的投毒，让劫持成功率更上一层楼。<br><strong>防范措施</strong>：由于这种攻击太过泛滥，以至大部分路由器都带了防 ARP 攻击的功能。客户端的 ARP 防火墙也数不胜数，似乎成了安全软件的标配。当然，系统也支持强制绑定 IP 与 MAC 的对应，必要时可以使用。</p>
<h2 id="伪装的DHCP服务器"><a href="#伪装的DHCP服务器" class="headerlink" title="伪装的DHCP服务器"></a>伪装的DHCP服务器</h2><p>​       由于没有配置IP地址、网关、DNS 等，在网络上是寸步难行的，因此首先需要从 DHCP 那获得这些信息。然而，既然连 IP 地址都没有，那又是如何通信的？显然，只能发到广播地址（255.255.255.255）上，而自己则暂时使用无效的IP地址（0.0.0.0）。（事实上，链路层的通信只要有 MAC 地址就行，IP 地址已属于网络层了，但 DHCP 由于某些特殊需要使用的是 UDP 协议）<br>​       因为是发往广播，内网环境里的所有用户都能听到。如果存在多个DHCP服务器，则分别予以回复；用户则选择最先收到的。由于规则是如此简单，以至于用户没有选择的余地。<br>​       如果有黑客也在内网里也开启了 DHCP 服务，用户收到的回复包很可能就是黑客发出的，这时用户的网络配置就会听由黑客接管了，被劫持就是不能避免的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/01/流量劫持/" data-id="cj0yptjs4000044s2nqz7gohk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/流量劫持/">流量劫持</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-传奇单机BackMir逆向" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/传奇单机BackMir逆向/" class="article-date">
  <time datetime="2017-03-31T07:31:07.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/传奇单机BackMir逆向/">传奇单机BackMir逆向</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="GamePlayer"><a href="#GamePlayer" class="headerlink" title="GamePlayer"></a>GamePlayer</h2><ul>
<li>GamePlayer struc ; (sizeof=0xABC, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">baseclass_0</td>
<td style="text-align:center"><a href="#GameOtherPlayer">GameOtherPlayer</a></td>
</tr>
<tr>
<td style="text-align:center">00000794</td>
<td style="text-align:center">m_equipAttrib</td>
<td style="text-align:center">PlayerEquipAttrib</td>
</tr>
<tr>
<td style="text-align:center">000007C8</td>
<td style="text-align:center">m_pSprHum</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000007CC</td>
<td style="text-align:center">m_pSprHair</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000007D0</td>
<td style="text-align:center">m_pSprWeapon</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000007D4</td>
<td style="text-align:center">m_pSprState</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000007D8</td>
<td style="text-align:center">m_pSprMgc</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000007DC</td>
<td style="text-align:center">m_bag</td>
<td style="text-align:center">PlayerBag</td>
</tr>
<tr>
<td style="text-align:center">00000814</td>
<td style="text-align:center">m_indexs</td>
<td style="text-align:center">PlayerTexIndexTable</td>
</tr>
<tr>
<td style="text-align:center">0000081A</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000081B</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000081C</td>
<td style="text-align:center">m_atkTarget</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000820</td>
<td style="text-align:center">m_nMapID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000824</td>
<td style="text-align:center">m_stMagicDetail</td>
<td style="text-align:center">MagicDetail[25]</td>
</tr>
<tr>
<td style="text-align:center">000009B4</td>
<td style="text-align:center">m_xInputMap</td>
<td style="text-align:center"><code>std::map&lt;char,MagicDetail*,std::less&lt;char&gt;,std::allocator&lt;std::pair&lt;char const ,MagicDetail *&gt; &gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">000009D4</td>
<td style="text-align:center">m_xAccInputMap</td>
<td style="text-align:center"><code>std::map&lt;char,MagicDetail *,std::less&lt;char&gt;,std::allocator&lt;std::pair&lt;char const ,MagicDetail *&gt; &gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">000009F4</td>
<td style="text-align:center">m_bIsLocked</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000009F5</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000009F6</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000009F7</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000009F8</td>
<td style="text-align:center">m_dwLockType</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000009FC</td>
<td style="text-align:center">m_dwLastLockedTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A00</td>
<td style="text-align:center">m_bIsWalkLocked</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A01</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A02</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A03</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A04</td>
<td style="text-align:center">m_dwLastLockedWalkTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A08</td>
<td style="text-align:center">m_pMgcTarget</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A0C</td>
<td style="text-align:center">m_dwLastUseMagicTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A10</td>
<td style="text-align:center">m_nSaveIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A14</td>
<td style="text-align:center">m_szSaveName</td>
<td style="text-align:center">char[20]</td>
</tr>
<tr>
<td style="text-align:center">00000A28</td>
<td style="text-align:center">m_xMgcHistory</td>
<td style="text-align:center"><code>std::map&lt;unsigned long,unsigned long,std::less&lt;unsigned long&gt;,std::allocator&lt;std::pair&lt;unsigned long const ,unsigned long&gt; &gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00000A48</td>
<td style="text-align:center">m_xDrugCoolDown</td>
<td style="text-align:center">CoolDownController</td>
</tr>
<tr>
<td style="text-align:center">00000A68</td>
<td style="text-align:center">m_xQuest</td>
<td style="text-align:center">QuestContext</td>
</tr>
<tr>
<td style="text-align:center">00000A7C</td>
<td style="text-align:center">m_szNameCopy</td>
<td style="text-align:center">char[20]</td>
</tr>
<tr>
<td style="text-align:center">00000A90</td>
<td style="text-align:center">m_uUID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A94</td>
<td style="text-align:center">m_nAccMagicID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000A98</td>
<td style="text-align:center">m_bUsingPreLock</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A99</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A9A</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A9B</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000A9C</td>
<td style="text-align:center">m_xNormalAtkRand</td>
<td style="text-align:center">RandGenerator</td>
</tr>
<tr>
<td style="text-align:center">00000AA0</td>
<td style="text-align:center">m_dwPreCalcNormalAttackEffMask</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000AA4</td>
<td style="text-align:center">m_bEnableLieHuo</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AA5</td>
<td style="text-align:center">m_bEnableSuperLieHuo</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AA6</td>
<td style="text-align:center">m_bEnableBanYue</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AA7</td>
<td style="text-align:center">m_bEnableCiSha</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AA8</td>
<td style="text-align:center">m_bEnableKtSword</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AA9</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AAA</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AAB</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AAC</td>
<td style="text-align:center">m_nWaitServerRspType</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000AB0</td>
<td style="text-align:center">m_dwWaitServerRspTimeoutTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000AB4</td>
<td style="text-align:center">m_nDonateLeft</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000AB8</td>
<td style="text-align:center">m_bRequestSmallQuit</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000AB9</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000ABA</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000ABB</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
</tbody>
</table>
<h2 id="GameOtherPlayer"><a href="#GameOtherPlayer" class="headerlink" title="GameOtherPlayer"></a>GameOtherPlayer</h2><ul>
<li>GameOtherPlayer struc (sizeof=0x794, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">baseclass_0</td>
<td style="text-align:center"><a href="#GameObject">GameObject</a></td>
</tr>
<tr>
<td style="text-align:center">000001E8</td>
<td style="text-align:center">m_equip</td>
<td style="text-align:center">ItemAttrib[13]</td>
</tr>
<tr>
<td style="text-align:center">000006C8</td>
<td style="text-align:center">m_fDetect</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006CC</td>
<td style="text-align:center">m_fMoveOffsetXTotal</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006D0</td>
<td style="text-align:center">m_fMoveOffsetYTotal</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006D4</td>
<td style="text-align:center">m_fLastUpdateSkill</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006D8</td>
<td style="text-align:center">m_fLastUpdateAttack</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006DC</td>
<td style="text-align:center">m_fLastUpdateDeath</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006E0</td>
<td style="text-align:center">m_fLastUpdateAttackNoWeapon</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006E4</td>
<td style="text-align:center">m_fLastUpdateAttackStop</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006E8</td>
<td style="text-align:center">m_fLastUpdateAttacked</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000006EC</td>
<td style="text-align:center">m_fLastUpdateMove dd</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">000006F0</td>
<td style="text-align:center">m_eEffect</td>
<td style="text-align:center">dd 4 dup</td>
</tr>
<tr>
<td style="text-align:center">00000700</td>
<td style="text-align:center">m_pMagicEffect</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000704</td>
<td style="text-align:center">m_pEffectRender dd</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">00000708</td>
<td style="text-align:center">m_bPlayOneStep</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000709</td>
<td style="text-align:center">m_bPlayTwoStep</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000070A</td>
<td style="text-align:center">m_bJob</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000070B</td>
<td style="text-align:center">db</td>
<td style="text-align:center">undefined</td>
</tr>
<tr>
<td style="text-align:center">0000070C</td>
<td style="text-align:center">m_dwLastAttackTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000710</td>
<td style="text-align:center">m_dwLastAttackStopTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000714</td>
<td style="text-align:center">m_dwLastAttackMode</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000718</td>
<td style="text-align:center">m_xHumStates</td>
<td style="text-align:center"><code>std::list&lt;MagicElement*,std::allocator&lt;MagicElement *&gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00000734</td>
<td style="text-align:center">m_dwJinGangExpireTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000738</td>
<td style="text-align:center">m_nLieHuoSkillLevel</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000073C</td>
<td style="text-align:center">m_nVipLevel</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000740</td>
<td style="text-align:center">m_dwLastNameColorChangeTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000744</td>
<td style="text-align:center">m_nLastNameColorIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000748</td>
<td style="text-align:center">m_xSkillInfo</td>
<td style="text-align:center"><code>std::map&lt;unsigned long,unsigned long,std::less&lt;unsigned long&gt;,std::allocator&lt;std::pair&lt;unsigned long const ,unsigned long&gt; &gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00000768</td>
<td style="text-align:center">m_stExtAttrib</td>
<td style="text-align:center">ExtendHeroAttrib</td>
</tr>
<tr>
<td style="text-align:center">00000794</td>
<td style="text-align:center">GameOtherPlayer ends</td>
</tr>
</tbody>
</table>
<h2 id="GameObject"><a href="#GameObject" class="headerlink" title="GameObject"></a>GameObject</h2><ul>
<li>GameObject struc (sizeof=0x1E8, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">baseclass_0</td>
<td style="text-align:center">RenderObject</td>
</tr>
<tr>
<td style="text-align:center">00000028</td>
<td style="text-align:center">baseclass_28</td>
<td style="text-align:center">PacketHandler</td>
</tr>
<tr>
<td style="text-align:center">00000030</td>
<td style="text-align:center">m_fPosx</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000034</td>
<td style="text-align:center">m_fPosy</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000038</td>
<td style="text-align:center">m_ptPos</td>
<td style="text-align:center">tagPOINT</td>
</tr>
<tr>
<td style="text-align:center">00000040</td>
<td style="text-align:center">m_type</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000044</td>
<td style="text-align:center">m_drt</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000048</td>
<td style="text-align:center">m_sex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000004C</td>
<td style="text-align:center">m_stat</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000050</td>
<td style="text-align:center">m_preStat</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000054</td>
<td style="text-align:center">m_attrib</td>
<td style="text-align:center">ItemAttrib</td>
</tr>
<tr>
<td style="text-align:center">000000B4</td>
<td style="text-align:center">m_fLastStandTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000B8</td>
<td style="text-align:center">m_bRenderName</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000000B9</td>
<td style="text-align:center">m_bHurt</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000000BA</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000000BB</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000000BC</td>
<td style="text-align:center">m_nCurrentTextureIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000C0</td>
<td style="text-align:center">m_nCurrentSelectIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000C4</td>
<td style="text-align:center">m_rcSelectRect</td>
<td style="text-align:center">tagRECT</td>
</tr>
<tr>
<td style="text-align:center">000000D4</td>
<td style="text-align:center">m_szSaying</td>
<td style="text-align:center">dw[80]</td>
</tr>
<tr>
<td style="text-align:center">00000174</td>
<td style="text-align:center">m_fSayingTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000178</td>
<td style="text-align:center">m_stSayingSize</td>
<td style="text-align:center">tagSIZE</td>
</tr>
<tr>
<td style="text-align:center">00000180</td>
<td style="text-align:center">m_dwLineNumber</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000184</td>
<td style="text-align:center">m_dwSayingColor</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000188</td>
<td style="text-align:center">m_dwHumEffectFlag</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000018C</td>
<td style="text-align:center">m_dwHumEffectTime</td>
<td style="text-align:center">dd[7]</td>
</tr>
<tr>
<td style="text-align:center">000001A8</td>
<td style="text-align:center">m_pMaster</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001AC</td>
<td style="text-align:center">m_szMasterName</td>
<td style="text-align:center">db[20]</td>
</tr>
<tr>
<td style="text-align:center">000001C0</td>
<td style="text-align:center">m_bTransparentMode</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001C1</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001C2</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001C3</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001C4</td>
<td style="text-align:center">m_eRenderMode</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001C8</td>
<td style="text-align:center">m_dwLastMoveTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001CC</td>
<td style="text-align:center">m_xAttackNumberList</td>
<td style="text-align:center"><code>std::list&lt;EffectAttackNumber *,std::allocator&lt;EffectAttackNumber *&gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">000001E8</td>
<td style="text-align:center">GameObject</td>
<td style="text-align:center">ends</td>
</tr>
</tbody>
</table>
<h2 id="ItemAttrib"><a href="#ItemAttrib" class="headerlink" title="ItemAttrib"></a>ItemAttrib</h2><ul>
<li>ItemAttrib      struc ; (sizeof=0x60, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">member</th>
<th style="text-align:center">offset</th>
<th style="text-align:center">size</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">id</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000004</td>
<td style="text-align:center">name</td>
<td style="text-align:center">char[20]</td>
</tr>
<tr>
<td style="text-align:center">00000018</td>
<td style="text-align:center">lucky</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000019</td>
<td style="text-align:center">curse</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001A</td>
<td style="text-align:center">hide</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001B</td>
<td style="text-align:center">accuracy</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001C</td>
<td style="text-align:center">atkSpeed</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001D</td>
<td style="text-align:center">atkPalsy</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001E</td>
<td style="text-align:center">atkPois</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000001F</td>
<td style="text-align:center">moveSpeed</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000020</td>
<td style="text-align:center">weight</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000021</td>
<td style="text-align:center">reqType</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000022</td>
<td style="text-align:center">reqValue</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000023</td>
<td style="text-align:center">sex</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000024</td>
<td style="text-align:center">type</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000025</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000026</td>
<td style="text-align:center">maxDC</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000028</td>
<td style="text-align:center">DC 攻击</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000002A</td>
<td style="text-align:center">maxAC</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000002C</td>
<td style="text-align:center">AC 物理防御力</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000002E</td>
<td style="text-align:center">maxMAC</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000030</td>
<td style="text-align:center">MAC 魔法防御力</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000032</td>
<td style="text-align:center">maxSC</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000034</td>
<td style="text-align:center">SC 道术</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000036</td>
<td style="text-align:center">maxMC</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000038</td>
<td style="text-align:center">MC 魔法</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000003A</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000003B</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000003C</td>
<td style="text-align:center">maxHP</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000040</td>
<td style="text-align:center">HP</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000044</td>
<td style="text-align:center">maxMP</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000048</td>
<td style="text-align:center">MP</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000004C</td>
<td style="text-align:center">maxEXPR</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000050</td>
<td style="text-align:center">EXPR 经验</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000054</td>
<td style="text-align:center">level</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000056</td>
<td style="text-align:center">extra</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000058</td>
<td style="text-align:center">tex</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000005A</td>
<td style="text-align:center">price</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000005C</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000060</td>
<td style="text-align:center">ItemAttrib  ends</td>
</tr>
</tbody>
</table>
<h2 id="PlayerEquipAttrib"><a href="#PlayerEquipAttrib" class="headerlink" title="PlayerEquipAttrib"></a>PlayerEquipAttrib</h2><ul>
<li>PlayerEquipAttrib (sizeof=0x34, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">nWeapon</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000004</td>
<td style="text-align:center">nCloth</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000008</td>
<td style="text-align:center">nNeck</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000000C</td>
<td style="text-align:center">nBrac</td>
<td style="text-align:center">dd[2]</td>
</tr>
<tr>
<td style="text-align:center">00000014</td>
<td style="text-align:center">nRing</td>
<td style="text-align:center">dd[2]</td>
</tr>
<tr>
<td style="text-align:center">0000001C</td>
<td style="text-align:center">nHelm</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000020</td>
<td style="text-align:center">nMedal</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000024</td>
<td style="text-align:center">nGem</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000028</td>
<td style="text-align:center">nShoe</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000002C</td>
<td style="text-align:center">nBelt</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000030</td>
<td style="text-align:center">nHairStyle</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000034</td>
<td style="text-align:center">PlayerEquipAttrib ends</td>
</tr>
</tbody>
</table>
<h2 id="MagicDetail"><a href="#MagicDetail" class="headerlink" title="MagicDetail"></a>MagicDetail</h2><ul>
<li>MagicDetail  (sizeof=0x10, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">cKey</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000001</td>
<td style="text-align:center">cAccKey</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000002</td>
<td style="text-align:center">db</td>
<td style="text-align:center">undefined</td>
</tr>
<tr>
<td style="text-align:center">00000003</td>
<td style="text-align:center">db</td>
<td style="text-align:center">undefined</td>
</tr>
<tr>
<td style="text-align:center">00000004</td>
<td style="text-align:center">szName</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000008</td>
<td style="text-align:center">dwTrain</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000000C</td>
<td style="text-align:center">cLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000000D</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000000E</td>
<td style="text-align:center">wID</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000010</td>
<td style="text-align:center">MagicDetail ends</td>
</tr>
</tbody>
</table>
<h2 id="ExtendHeroAttrib"><a href="#ExtendHeroAttrib" class="headerlink" title="ExtendHeroAttrib"></a>ExtendHeroAttrib</h2><ul>
<li>ExtendHeroAttrib (sizeof=0x2C, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">uHair</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000001</td>
<td style="text-align:center">uWing</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000002</td>
<td style="text-align:center">uSmeltOreLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000003</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000004</td>
<td style="text-align:center">uSmeltOreExp</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000006</td>
<td style="text-align:center">uSmeltWoodLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000007</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000008</td>
<td style="text-align:center">uSmeltWoodExp</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000000A</td>
<td style="text-align:center">uSmeltClothLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000000B</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000000C</td>
<td style="text-align:center">uSmeltClothExp</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">0000000E</td>
<td style="text-align:center">uSmeltGemLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000000F</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000010</td>
<td style="text-align:center">uSmeltGemExp</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000012</td>
<td style="text-align:center">uMakeEquipLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000013</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000014</td>
<td style="text-align:center">uMakeEquipExp</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000016</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000017</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000018</td>
<td style="text-align:center">uChatColor</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000001C</td>
<td style="text-align:center">uClothLook</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000020</td>
<td style="text-align:center">uWeaponLook</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000024</td>
<td style="text-align:center">uNameFrame</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000028</td>
<td style="text-align:center">uChatFrame</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000002C</td>
<td style="text-align:center">ExtendHeroAttrib ends</td>
</tr>
</tbody>
</table>
<h2 id="成果展示："><a href="#成果展示：" class="headerlink" title="成果展示："></a>成果展示：</h2><p>经过上述分析，做了个客户端辅助，通过按键精灵：</p>
<p><img src="/images/bm1.png" alt=""></p>
<p><img src="/images/bm2.png" alt=""></p>
<p><img src="/images/bm3.png" alt=""></p>
<p>自己道士玩得多，所以功能也弄得多，不过战士能自动打怪后，挂机比道士轻松太多。<br>PS：有几次开着这辅助玩LOL，被封了两次三天的号        拳头爸爸，我没用LOL外挂啊  TT</p>
<h2 id="GameSvr逆向笔记"><a href="#GameSvr逆向笔记" class="headerlink" title="GameSvr逆向笔记"></a>GameSvr逆向笔记</h2><ul>
<li>找全局变量：找到了全局经验表，以及加密经验表的mask的地址，配合cheatengine一小段lua脚本，让所有的升级经验都为1。可惜了，游戏就这么毁了。</li>
<li>EXPRTableMask 2DD2F0 (2.10.18)</li>
<li>EXPRTable 2CA570 (2.10.18)  </li>
<li>加密算法是异或，直接IDA修改数据是不行的，可能有一些检查和验证机制，但是cheatengine改加密后的数据是可行的。</li>
<li>很遗憾，后来经过查验，上面的地址是会变的，原因应该是基址发生变化，因为开启了ASLR，好在cheatengine支持符号作为地址，可以很容易找到所有的地址。</li>
</ul>
<h2 id="IDA分析出的所有符号列表："><a href="#IDA分析出的所有符号列表：" class="headerlink" title="IDA分析出的所有符号列表："></a>IDA分析出的所有符号列表：</h2><ul>
<li><code>gamesvr.g_bGlobalEncrypt</code>      标识全局数据是否加密</li>
<li><code>gamesvr.g_nExprTable</code>           经验表</li>
<li><code>gamesvr.g_nHPTable</code>               每级HP表</li>
<li><code>gamesvr.g_nMPTable</code>               每级MP表</li>
<li><code>gamesvr.g_nWanLiTable</code>           每级腕力表</li>
<li><code>gamesvr.g_pxHeros</code>:当前在线用户列表（指针类型），定义的是GameObject类型，可强制转换，看到了强制转换代码</li>
<li><code>gamesvr.g_xMagicInfoTable</code>     角色技能表 <code>vector&lt;MonsLogicItem&gt;</code></li>
<li><code>gamesvr.g_xUserInfoList</code>         暂时没研究</li>
</ul>
<h2 id="服务端GameObject"><a href="#服务端GameObject" class="headerlink" title="服务端GameObject"></a>服务端GameObject</h2><ul>
<li>GameObject  (sizeof=0x1D8, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">baseclass_0</td>
<td style="text-align:center">LockObject</td>
</tr>
<tr>
<td style="text-align:center">0000001C</td>
<td style="text-align:center">m_uID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000020</td>
<td style="text-align:center">m_dwLastExeTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000024</td>
<td style="text-align:center">m_dwTotalExeTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000028</td>
<td style="text-align:center">m_eType</td>
<td style="text-align:center">dd enum SERVER_OBJECT_TYPE</td>
</tr>
<tr>
<td style="text-align:center">0000002C</td>
<td style="text-align:center">m_dwLastMoveTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000030</td>
<td style="text-align:center">m_dwLastAttackTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000034</td>
<td style="text-align:center">m_dwLastDeathTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000038</td>
<td style="text-align:center">m_stData</td>
<td style="text-align:center">UserData</td>
</tr>
<tr>
<td style="text-align:center">000000B0</td>
<td style="text-align:center">m_xMsgQueue</td>
<td style="text-align:center">ByteBuffer</td>
</tr>
<tr>
<td style="text-align:center">000000C4</td>
<td style="text-align:center">m_dwLastWalkTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000C8</td>
<td style="text-align:center">m_dwWalkInterval</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000CC</td>
<td style="text-align:center">m_dwLastStruckTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000D0</td>
<td style="text-align:center">m_dwLastDeadTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000D4</td>
<td style="text-align:center">m_dwLastSearchTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000D8</td>
<td style="text-align:center">m_dwLastRunTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000DC</td>
<td style="text-align:center">m_dwRunInterval</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000E0</td>
<td style="text-align:center">m_dwCurrentTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000E4</td>
<td style="text-align:center">m_wLastValidPositionX</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">000000E6</td>
<td style="text-align:center">m_wLastValidPositionY</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">000000E8</td>
<td style="text-align:center">m_dwHumEffFlag</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000000EC</td>
<td style="text-align:center">m_dwHumEffTime</td>
<td style="text-align:center">dd 11 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00000118</td>
<td style="text-align:center">m_dwSupply</td>
<td style="text-align:center">dd 8 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00000138</td>
<td style="text-align:center">m_dwHealSupply</td>
<td style="text-align:center">dd 4 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00000148</td>
<td style="text-align:center">m_dwEnergyShieldSupply</td>
<td style="text-align:center">dd 4 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00000158</td>
<td style="text-align:center">m_dwLastIncHPTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000015C</td>
<td style="text-align:center">m_dwLastHealIncHPTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000160</td>
<td style="text-align:center">m_dwLastIncMPTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000164</td>
<td style="text-align:center">m_dwACInrease</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000168</td>
<td style="text-align:center">m_dwPoison</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000016C</td>
<td style="text-align:center">m_dwLastUpdatePoisonTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000170</td>
<td style="text-align:center">m_dwLastAddHpMpTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000174</td>
<td style="text-align:center">m_dwDefectTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000178</td>
<td style="text-align:center">m_pValid</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000017C</td>
<td style="text-align:center">m_dwLastCheckValidTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000180</td>
<td style="text-align:center">m_bStoneRestore</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000181</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000182</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000183</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000184</td>
<td style="text-align:center">m_pStatusCtrl</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000188</td>
<td style="text-align:center">m_xStates</td>
<td style="text-align:center">StateController</td>
</tr>
<tr>
<td style="text-align:center">000001A8</td>
<td style="text-align:center">m_dwInvalidMsgQueueTimes</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001AC</td>
<td style="text-align:center">m_bNetDataValid</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001AD</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001AE</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001AF</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001B0</td>
<td style="text-align:center">m_nTotalRecvDamage</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001B4</td>
<td style="text-align:center">m_bCanPosion</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001B5</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001B6</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001B7</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000001B8</td>
<td style="text-align:center">m_dwHPRecoverInterval</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001BC</td>
<td style="text-align:center">m_xDelayActions</td>
<td style="text-align:center"><code>std::list&lt;DelayActionBase *,std::allocator&lt;DelayActionBase *&gt;</code></td>
</tr>
<tr>
<td style="text-align:center">000001D8</td>
<td style="text-align:center">GameObject      ends</td>
</tr>
</tbody>
</table>
<h2 id="HeroOBject"><a href="#HeroOBject" class="headerlink" title="HeroOBject"></a>HeroOBject</h2><ul>
<li>HeroObject  (sizeof=0x33A4, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">baseclass_0</td>
<td style="text-align:center">GameObject</td>
</tr>
<tr>
<td style="text-align:center">000001D8</td>
<td style="text-align:center">m_xBag</td>
<td style="text-align:center"><code>std::vector&lt;ItemAttrib,std::allocator&lt;ItemAttrib&gt;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center">000001F0</td>
<td style="text-align:center">m_nMoney</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000001F4</td>
<td style="text-align:center">m_stEquip</td>
<td style="text-align:center">ItemAttrib 13 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">000006D4</td>
<td style="text-align:center">m_stStore</td>
<td style="text-align:center">ItemAttrib 36 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00001454</td>
<td style="text-align:center">m_stBigStore</td>
<td style="text-align:center">ItemAttrib 80 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00003254</td>
<td style="text-align:center">m_bBigStoreReceived</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003255</td>
<td style="text-align:center">m_bClientLoaded</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003256</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003257</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003258</td>
<td style="text-align:center">m_xQuest</td>
<td style="text-align:center">QuestContext</td>
</tr>
<tr>
<td style="text-align:center">0000326C</td>
<td style="text-align:center">m_nAssistItemSum</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003270</td>
<td style="text-align:center">m_dwIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003274</td>
<td style="text-align:center">m_dwDefence</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003278</td>
<td style="text-align:center">m_xMagics</td>
<td style="text-align:center"><code>std::vector&lt;UserMagic,std::allocator&lt;UserMagic&gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00003290</td>
<td style="text-align:center">m_dwLastCityMap</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00003292</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003293</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003294</td>
<td style="text-align:center">m_pSlaves</td>
<td style="text-align:center">dd 3 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">000032A0</td>
<td style="text-align:center">m_dwLastSpellTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032A4</td>
<td style="text-align:center">m_dwTimeOut</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032A8</td>
<td style="text-align:center">m_bIsNewHero</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032A9</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032AA</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032AB</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032AC</td>
<td style="text-align:center">m_dwLastReviveTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032B0</td>
<td style="text-align:center">m_uVersion</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">000032B2</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032B3</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032B4</td>
<td style="text-align:center">m_dwLastCheckTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032B8</td>
<td style="text-align:center">m_nGainedExp</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032BC</td>
<td style="text-align:center">m_dwLastUseMoveRingTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032C0</td>
<td style="text-align:center">m_nTeamID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032C4</td>
<td style="text-align:center">m_dwLastRecvDataTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032C8</td>
<td style="text-align:center">m_dwLastLoginMinutes</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032CC</td>
<td style="text-align:center">m_dwKilledMonsterCounter</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032D0</td>
<td style="text-align:center">m_dwDoubleDropExpireTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032D4</td>
<td style="text-align:center">m_dwReviveRingUseTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032D8</td>
<td style="text-align:center">m_dwLSIndex</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032DC</td>
<td style="text-align:center">m_dwUID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032E0</td>
<td style="text-align:center">m_bGmHide</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032E1</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032E2</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032E3</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032E4</td>
<td style="text-align:center">m_dwLastPrivateChatTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032E8</td>
<td style="text-align:center">m_dwLastTeamChatTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032EC</td>
<td style="text-align:center">m_dwLastReqOffSellItems</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032F0</td>
<td style="text-align:center">m_dwLastReqOffTakeBack</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032F4</td>
<td style="text-align:center">m_dwJinGangExpireTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000032F8</td>
<td style="text-align:center">m_bUnUse</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032F9</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032FA</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032FB</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000032FC</td>
<td style="text-align:center">m_nAbnormalSpeedTimes</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003300</td>
<td style="text-align:center">m_dwLoginTimeTick</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003304</td>
<td style="text-align:center">m_bCheckSoldItems</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003305</td>
<td style="text-align:center">m_cAutoSaveCounter</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003306</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003307</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003308</td>
<td style="text-align:center">m_nDonateMoney</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000330C</td>
<td style="text-align:center">m_nDonateLeft</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003310</td>
<td style="text-align:center">m_xGiftItemIDs</td>
<td style="text-align:center"><code>std::vector&lt;int,std::allocator&lt;int&gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00003328</td>
<td style="text-align:center">m_xDrugUseTime</td>
<td style="text-align:center"><code>std::map&lt;int,unsigned long,std::less&lt;int&gt;,std::allocator&lt;std::pair&lt;int const ,unsigned long&gt; &gt; &gt;</code></td>
</tr>
<tr>
<td style="text-align:center">00003348</td>
<td style="text-align:center">m_dwServerNetDelaySec</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000334C</td>
<td style="text-align:center">m_dwLastCheckServerNetDelay</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003350</td>
<td style="text-align:center">m_nServerNetDelaySeq</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003354</td>
<td style="text-align:center">m_xNormalAttackRand</td>
<td style="text-align:center">RandGenerator</td>
</tr>
<tr>
<td style="text-align:center">00003358</td>
<td style="text-align:center">m_stExtAttrib</td>
<td style="text-align:center">ExtendHeroAttrib</td>
</tr>
<tr>
<td style="text-align:center">00003384</td>
<td style="text-align:center">m_bLastAttackCritical</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003385</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003386</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003387</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003388</td>
<td style="text-align:center">m_nEnterTimeLimitMapTime</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000338C</td>
<td style="text-align:center">m_nTimeLimitID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003390</td>
<td style="text-align:center">m_nLastUseMagicID</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00003394</td>
<td style="text-align:center">m_bNeedTransAni</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003395</td>
<td style="text-align:center">m_byteDifficultyLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003396</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003397</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00003398</td>
<td style="text-align:center">m_ePkType</td>
<td style="text-align:center">dd  enum HeroPkType</td>
</tr>
<tr>
<td style="text-align:center">0000339C</td>
<td style="text-align:center">m_bSmallQuit</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000339D</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000339E</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">0000339F</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">000033A0</td>
<td style="text-align:center">m_nExtraSuitType</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">000033A4</td>
<td style="text-align:center">HeroObject      ends</td>
</tr>
</tbody>
</table>
<h2 id="UserData"><a href="#UserData" class="headerlink" title="UserData"></a>UserData</h2><ul>
<li>UserData (sizeof=0x78, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">stAttrib</td>
<td style="text-align:center">ItemAttrib   同客户端</td>
</tr>
<tr>
<td style="text-align:center">00000060</td>
<td style="text-align:center">wCoordX</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000062</td>
<td style="text-align:center">wCoordY</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000064</td>
<td style="text-align:center">wMapID</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000066</td>
<td style="text-align:center">undefined</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000067</td>
<td style="text-align:center">undefined</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000068</td>
<td style="text-align:center">eServerState</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000006C</td>
<td style="text-align:center">eGameState</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000070</td>
<td style="text-align:center">nDrt</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000074</td>
<td style="text-align:center">bJob</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000075</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000076</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000077</td>
<td style="text-align:center">-</td>
<td style="text-align:center">db</td>
</tr>
</tbody>
</table>
<h2 id="属性加解密函数"><a href="#属性加解密函数" class="headerlink" title="属性加解密函数"></a>属性加解密函数</h2><ul>
<li><p>DecryptValue</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">cdecl <span class="title">DecryptValue</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> _mask, <span class="keyword">unsigned</span> <span class="keyword">int</span> _value)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> _valuea; <span class="comment">// [sp+10h] [bp+Ch]@10</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> _valueb; <span class="comment">// [sp+10h] [bp+Ch]@19</span></div><div class="line"></div><div class="line">  <span class="keyword">if</span> ( _mask &gt;= <span class="number">0xFF</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( _mask &gt;= <span class="number">0xFFFF</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ( _mask &lt; <span class="number">0xFFFFFFFF</span> &amp;&amp; _value &amp; <span class="number">0x8000000</span> )</div><div class="line">      &#123;</div><div class="line">        <span class="keyword">if</span> ( _value &amp; <span class="number">0x40000000</span> )</div><div class="line">          _valueb = _value &amp; <span class="number">0xBFFFFFFF</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">          _valueb = _value | <span class="number">0x40000000</span>;</div><div class="line">        <span class="keyword">if</span> ( _valueb &amp; <span class="number">0x80000</span> )</div><div class="line">          _value = _valueb &amp; <span class="number">0xFFF7FFFF</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">          _value = _valueb | <span class="number">0x80000</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( _value &amp; <span class="number">0x4000</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ( _value &amp; <span class="number">0x1000</span> )</div><div class="line">        _valuea = _value &amp; <span class="number">0xFFFFEFFF</span>;</div><div class="line">      <span class="keyword">else</span></div><div class="line">        _valuea = _value | <span class="number">0x1000</span>;</div><div class="line">      <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x40</span> )</div><div class="line">        _value = _valuea &amp; <span class="number">0xFFFFFFBF</span>;</div><div class="line">      <span class="keyword">else</span></div><div class="line">        _value = _valuea | <span class="number">0x40</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( _value &amp; <span class="number">0x80</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( _value &amp; <span class="number">0x20</span> )</div><div class="line">      _value &amp;= <span class="number">0xFFFFFFDF</span>;</div><div class="line">    <span class="keyword">else</span></div><div class="line">      _value |= <span class="number">0x20</span>u;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> _mask ^ _value;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>EncryptValue</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">cdecl <span class="title">EncryptValue</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> _mask, <span class="keyword">unsigned</span> <span class="keyword">int</span> _value)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> _valuea; <span class="comment">// [sp+10h] [bp+Ch]@1</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> _valueb; <span class="comment">// [sp+10h] [bp+Ch]@10</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> _valuec; <span class="comment">// [sp+10h] [bp+Ch]@19</span></div><div class="line"></div><div class="line">  _valuea = _mask ^ _value;</div><div class="line">  <span class="keyword">if</span> ( _mask &gt;= <span class="number">0xFF</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( _mask &gt;= <span class="number">0xFFFF</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ( _mask &lt; <span class="number">0xFFFFFFFF</span> &amp;&amp; _valuea &amp; <span class="number">0x8000000</span> )</div><div class="line">      &#123;</div><div class="line">        <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x40000000</span> )</div><div class="line">          _valuec = _valuea &amp; <span class="number">0xBFFFFFFF</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">          _valuec = _valuea | <span class="number">0x40000000</span>;</div><div class="line">        <span class="keyword">if</span> ( _valuec &amp; <span class="number">0x80000</span> )</div><div class="line">          _valuea = _valuec &amp; <span class="number">0xFFF7FFFF</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">          _valuea = _valuec | <span class="number">0x80000</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x4000</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x1000</span> )</div><div class="line">        _valueb = _valuea &amp; <span class="number">0xFFFFEFFF</span>;</div><div class="line">      <span class="keyword">else</span></div><div class="line">        _valueb = _valuea | <span class="number">0x1000</span>;</div><div class="line">      <span class="keyword">if</span> ( _valueb &amp; <span class="number">0x40</span> )</div><div class="line">        _valuea = _valueb &amp; <span class="number">0xFFFFFFBF</span>;</div><div class="line">      <span class="keyword">else</span></div><div class="line">        _valuea = _valueb | <span class="number">0x40</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x80</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( _valuea &amp; <span class="number">0x20</span> )</div><div class="line">      _valuea &amp;= <span class="number">0xFFFFFFDF</span>;</div><div class="line">    <span class="keyword">else</span></div><div class="line">      _valuea |= <span class="number">0x20</span>u;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> _valuea;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="成果展示：-1"><a href="#成果展示：-1" class="headerlink" title="成果展示："></a>成果展示：</h3></li>
</ul>
<p>找到经验表，找到经验Mask，把所有升级经验都置为1，不到5分钟，一个80级新手村号诞生了！</p>
<p><img src="/images/zs80.png" alt=""></p>
<p>晚上使用Cheatengine写了个刷金币服务端挂：</p>
<p><img src="/images/wg.png" alt=""></p>
<p>游戏最多携带1亿金币，点了按钮，然后卖点东西或者买点东西就可以刷出金币。</p>
<h2 id="角色全技能尝试"><a href="#角色全技能尝试" class="headerlink" title="角色全技能尝试"></a>角色全技能尝试</h2><p>为了让角色能获得全技能，首先要找到角色信息的位置，这个已经通过<code>g_pxHeros</code>找到了，其次需要看一下服务端对角色学习技能的设定：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">char</span> __thiscall HeroObject::AddUserMagic(HeroObject *<span class="keyword">this</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span> _dwMgcID)</div><div class="line">&#123;</div><div class="line">  MagicInfo *v3; <span class="comment">// esi@6</span></div><div class="line">  MagicInfo *v4; <span class="comment">// esi@11</span></div><div class="line">  MagicInfo *v5; <span class="comment">// esi@16</span></div><div class="line">  HeroObject *thisa; <span class="comment">// [sp+4h] [bp-4h]@1</span></div><div class="line"></div><div class="line">  thisa = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">if</span> ( <span class="keyword">this</span>-&gt;m_stData.bJob &gt; <span class="number">2</span> )</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">if</span> ( <span class="keyword">this</span>-&gt;m_stData.bJob )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( <span class="keyword">this</span>-&gt;m_stData.bJob == <span class="number">1</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ( _dwMgcID &gt; <span class="number">0x1C</span> &amp;&amp; _dwMgcID &lt; <span class="number">0x2C</span> )</div><div class="line">      &#123;</div><div class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;<span class="keyword">this</span>-&gt;m_xMagics, _dwMgcID - <span class="number">29</span>)-&gt;bLevel = <span class="number">1</span>;</div><div class="line">        v4 = (MagicInfo *)<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt;&gt;::<span class="keyword">operator</span>[](</div><div class="line">                            &amp;g_xMagicInfoTable,</div><div class="line">                            _dwMgcID);</div><div class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;thisa-&gt;m_xMagics, _dwMgcID - <span class="number">29</span>)-&gt;pInfo = v4;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="keyword">this</span>-&gt;m_stData.bJob == <span class="number">2</span> &amp;&amp; _dwMgcID &gt; <span class="number">0x37</span> &amp;&amp; _dwMgcID &lt; <span class="number">0x48</span> )</div><div class="line">    &#123;</div><div class="line">      <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;<span class="keyword">this</span>-&gt;m_xMagics, _dwMgcID - <span class="number">56</span>)-&gt;bLevel = <span class="number">1</span>;</div><div class="line">      v5 = (MagicInfo *)<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt;&gt;::<span class="keyword">operator</span>[](</div><div class="line">                          &amp;g_xMagicInfoTable,</div><div class="line">                          _dwMgcID);</div><div class="line">      <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;thisa-&gt;m_xMagics, _dwMgcID - <span class="number">56</span>)-&gt;pInfo = v5;</div><div class="line">      <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( _dwMgcID &gt; <span class="number">1</span> &amp;&amp; _dwMgcID &lt; <span class="number">0xE</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;<span class="keyword">this</span>-&gt;m_xMagics, _dwMgcID - <span class="number">2</span>)-&gt;bLevel = <span class="number">1</span>;</div><div class="line">    v3 = (MagicInfo *)<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt;&gt;::<span class="keyword">operator</span>[](&amp;g_xMagicInfoTable, _dwMgcID);</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;UserMagic,<span class="built_in">std</span>::allocator&lt;UserMagic&gt;&gt;::<span class="keyword">operator</span>[](&amp;thisa-&gt;m_xMagics, _dwMgcID - <span class="number">2</span>)-&gt;pInfo = v3;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>看到这里，大致可以了解，每个角色的技能信息放在一个<code>vector</code>里面，然后<code>vector</code>里面的每一个元素都是<code>UserMagic</code>，里面存了技能信息和技能等级。不过它的存储结构不是数组，是<code>vector</code>。vector是动态分配内存的，我去看了下<code>operator[]</code>的实现部分：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">MonsLogicItem *__thiscall <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt;&gt;::<span class="keyword">operator</span>[](<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt; &gt; *<span class="keyword">this</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span> _Pos)</div><div class="line">&#123;</div><div class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MonsLogicItem,<span class="built_in">std</span>::allocator&lt;MonsLogicItem&gt; &gt; *thisa; <span class="comment">// [sp+0h] [bp-4h]@1</span></div><div class="line"></div><div class="line">  thisa = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">if</span> ( _Pos &gt;= <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;MagicInfo,<span class="built_in">std</span>::allocator&lt;MagicInfo&gt;&gt;::size(<span class="keyword">this</span>) )</div><div class="line">    __invalid_parameter_noinfo();</div><div class="line">  <span class="keyword">return</span> &amp;thisa-&gt;_Myfirst[_Pos];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>_Myfirst</code>的偏移是0xC,这对每一个vector都是固定的，后面就是数组操作了，此时我淡定了，以前学习STL的时候只知道vector的内存大小是按需分配，而且会预先分配。此时我才知道vector的内存分配其实就是维护了一个数组，前面那0xC的大小应该是存储数组大小什么的。唉，果然学习STL的时候没有深入理解啊。真是应了那句<code>源码之前，了无秘密</code>。PS：我还是去翻了下书的  哈哈。。。</p>
<p>开始之前必须知道<code>MagicInfo</code>和<code>Usermagic</code>的大小：</p>
<h3 id="MonsLogicItem"><a href="#MonsLogicItem" class="headerlink" title="MonsLogicItem"></a>MonsLogicItem</h3><ul>
<li>(sizeof=0x1C, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">wID</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000002</td>
<td style="text-align:center">wLevel</td>
<td style="text-align:center">dw 7 dup(?)</td>
</tr>
<tr>
<td style="text-align:center">00000010</td>
<td style="text-align:center">bJob</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000011</td>
<td style="text-align:center">bMultiple</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000012</td>
<td style="text-align:center">wIncrease</td>
<td style="text-align:center">dw</td>
</tr>
<tr>
<td style="text-align:center">00000014</td>
<td style="text-align:center">bBaseCost</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000015</td>
<td style="text-align:center">undefined</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000016</td>
<td style="text-align:center">undefined</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000017</td>
<td style="text-align:center">undefined</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000018</td>
<td style="text-align:center">dwDelay</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">0000001C</td>
<td style="text-align:center">MagicInfo ends</td>
</tr>
</tbody>
</table>
<h3 id="UserMagic"><a href="#UserMagic" class="headerlink" title="UserMagic"></a>UserMagic</h3><ul>
<li>struc ; (sizeof=0x8, align=0x4)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">offset</th>
<th style="text-align:center">member</th>
<th style="text-align:center">size/type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">00000000</td>
<td style="text-align:center">pInfo</td>
<td style="text-align:center">dd</td>
</tr>
<tr>
<td style="text-align:center">00000004</td>
<td style="text-align:center">bLevel</td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000005</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000006</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000007</td>
<td style="text-align:center"></td>
<td style="text-align:center">db</td>
</tr>
<tr>
<td style="text-align:center">00000008</td>
<td style="text-align:center">UserMagic       ends</td>
</tr>
</tbody>
</table>
<p>某次测试结果如下：</p>
<p><img src="/images/magicinfo.png" alt=""></p>
<p>计算一下，发现一共有73个技能的储存空间（所有技能应该没有这么多）。然后去看一下第一个用户初始化之后他的vector到底有多大的空间：</p>
<p><img src="/images/user1magic.png" alt=""></p>
<p>计算了一下，只有19个技能的空间。从上面的代码看了一下，战士有11个技能，道士有16个技能，魔法师有15个技能，还好，总算没超过它预先分配的大小，要是超了，我就没啥办法了，我可没有那闲工夫帮<code>vector</code>维护内存空间。</p>
<h2 id="成果展示：-2"><a href="#成果展示：-2" class="headerlink" title="成果展示："></a>成果展示：</h2><p>经过细密仔细的计算偏移，慢慢调试，终于成功地实现了全技能6级：</p>
<p><img src="/images/magic6_1.png" alt=""></p>
<p><img src="/images/magic6_2.png" alt=""></p>
<p><img src="/images/magic6_3.png" alt=""></p>
<p>粘一段代码，防止忘记：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setAllMagic</span><span class="params">(hero)</span></span></div><div class="line">    Magic_First = getAddress(<span class="string">"gamesvr.g_xMagicInfoTable"</span>) + <span class="number">0xC</span></div><div class="line">    job = readBytes(hero+<span class="number">0x38</span>+<span class="number">0x74</span>, <span class="number">1</span>, <span class="literal">false</span>)</div><div class="line">    hero_magic_first = readInteger(hero+<span class="number">0x3278</span>+<span class="number">0xC</span>)</div><div class="line">    <span class="keyword">if</span> job == <span class="number">0</span> <span class="keyword">then</span></div><div class="line">       <span class="keyword">for</span> i = <span class="number">2</span>,<span class="number">0xE</span> <span class="keyword">do</span></div><div class="line">           magic_addr = Magic_First+<span class="number">0xC</span>+i*<span class="number">0x1C</span></div><div class="line">           writeInteger(hero_magic_first+(i<span class="number">-2</span>)*<span class="number">8</span>, magic_addr)</div><div class="line">           writeBytes(hero_magic_first+(i<span class="number">-2</span>)*<span class="number">8</span>+<span class="number">4</span>, <span class="number">6</span>)</div><div class="line">       <span class="keyword">end</span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> job == <span class="number">1</span> <span class="keyword">then</span></div><div class="line">         <span class="keyword">for</span> i = <span class="number">0x1D</span>,<span class="number">0x2C</span> <span class="keyword">do</span></div><div class="line">           magic_addr = Magic_First+<span class="number">0xC</span>+i*<span class="number">0x1C</span></div><div class="line">           writeInteger(hero_magic_first+(i<span class="number">-0x1D</span>)*<span class="number">8</span>, magic_addr)</div><div class="line">           writeBytes(hero_magic_first+(i<span class="number">-0x1D</span>)*<span class="number">8</span>+<span class="number">4</span>, <span class="number">6</span>)</div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">for</span> i = <span class="number">0x38</span>,<span class="number">0x48</span> <span class="keyword">do</span></div><div class="line">           magic_addr = Magic_First+<span class="number">0xC</span>+i*<span class="number">0x1C</span></div><div class="line">           writeInteger(hero_magic_first+(i<span class="number">-0x38</span>)*<span class="number">8</span>, magic_addr)</div><div class="line">           writeBytes(hero_magic_first+(i<span class="number">-0x38</span>)*<span class="number">8</span>+<span class="number">4</span>, <span class="number">6</span>)</div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>至此，游戏已经不能好好地玩了。下面的目标只能是刷装备，这个需要装备代码，有个数据库已经知道密码了，但是sqlcipher就是打不开，还有待研究啊。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/03/31/传奇单机BackMir逆向/" data-id="cj0yptjs5000244s2ycld8hur" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BackMir/">BackMir</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/逆向/">逆向</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/hello-world/" class="article-date">
  <time datetime="2017-03-31T06:57:07.883Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/03/31/hello-world/" data-id="cj0yptjs5000144s2fhpz26rv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BackMir/">BackMir</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/流量劫持/">流量劫持</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/逆向/">逆向</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/BackMir/" style="font-size: 10px;">BackMir</a> <a href="/tags/流量劫持/" style="font-size: 10px;">流量劫持</a> <a href="/tags/逆向/" style="font-size: 10px;">逆向</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/04/01/流量劫持/">流量劫持</a>
          </li>
        
          <li>
            <a href="/2017/03/31/传奇单机BackMir逆向/">传奇单机BackMir逆向</a>
          </li>
        
          <li>
            <a href="/2017/03/31/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 bertcug<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>